# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

## üîí –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –∑–∞—â–∏—Ç—ã

### 1. Rate Limiting (–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤)

**–§–∞–π–ª:** `src/lib/security/rateLimit.ts`

–ó–∞—â–∏—Ç–∞ –æ—Ç DDoS –∏ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è API:

- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** 5 –ø–æ–ø—ã—Ç–æ–∫ –≤ 15 –º–∏–Ω—É—Ç
- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:** 3 –ø–æ–ø—ã—Ç–∫–∏ –≤ —á–∞—Å
- **–û–±—â–∏–µ API:** 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:** 200 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ `src/middleware.ts`

### 2. –ó–∞—â–∏—Ç–∞ –æ—Ç Brute Force –∞—Ç–∞–∫

**–§–∞–π–ª:** `src/lib/security/bruteForce.ts`

- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ—Å–ª–µ 5 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 30 –º–∏–Ω—É—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### 3. –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–§–∞–π–ª:** `src/lib/security/validation.ts`

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Zod –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏:

- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è email
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö –∫–æ–¥–æ–≤
- ‚úÖ –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–æ–∫ (–∑–∞—â–∏—Ç–∞ –æ—Ç XSS)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è ID (cuid2 —Ñ–æ—Ä–º–∞—Ç)

### 4. –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏

**–§–∞–π–ª:** `src/lib/security/headers.ts`, `next.config.ts`

- **Content-Security-Policy** - –∑–∞—â–∏—Ç–∞ –æ—Ç XSS
- **X-Content-Type-Options: nosniff** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ MIME-sniffing
- **X-Frame-Options: DENY** - –∑–∞—â–∏—Ç–∞ –æ—Ç clickjacking
- **X-XSS-Protection** - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç XSS
- **Referrer-Policy** - –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–µ—Ä–µ–¥–∞—á–∏ referrer
- **Strict-Transport-Security (HSTS)** - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTPS

### 5. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–§–∞–π–ª:** `src/lib/security/logger.ts`

–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:

- Brute force –ø–æ–ø—ã—Ç–∫–∏
- –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ rate limit
- –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø
- –ü–æ–ø—ã—Ç–∫–∏ SQL injection
- –ü–æ–ø—ã—Ç–∫–∏ XSS

### 6. –ó–∞—â–∏—Ç–∞ –ø–∞—Ä–æ–ª–µ–π

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ bcrypt –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è: 6 —Å–∏–º–≤–æ–ª–æ–≤
- –ü–∞—Ä–æ–ª–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

### 7. –ó–∞—â–∏—Ç–∞ –æ—Ç SQL Injection

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (prepared statements)
- –í—Å–µ SQL –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `$1, $2, ...`
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å—Ç—Ä–æ–∫ –≤ SQL

### 8. Middleware –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–§–∞–π–ª:** `src/middleware.ts`

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
- Rate limiting –¥–ª—è –≤—Å–µ—Ö API routes
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

## üõ°Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Redis –¥–ª—è rate limiting**
   - –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç in-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
   - –î–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Redis

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å (Sentry, LogRocket)
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

3. **–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**
   - –û–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ
   - –°–ª–µ–¥–∏—Ç–µ –∑–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—è–º–∏ –≤ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–∞–∫–µ—Ç–∞—Ö

4. **HTTPS –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω**
   - –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ HSTS –∑–∞–≥–æ–ª–æ–≤–∫–∏

5. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ CORS**
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ CORS –ø–æ–ª–∏—Ç–∏–∫—É –¥–ª—è API
   - –†–∞–∑—Ä–µ—à–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–æ–º–µ–Ω—ã

6. **–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∞—É–¥–∏—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
   - –ü—Ä–æ–≤–æ–¥–∏—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ç–∏–ø–∞ Snyk, npm audit

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```typescript
import { getRecentLogs, getLogsByType, SecurityEventType } from "@/lib/security/logger";

// –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å–æ–±—ã—Ç–∏–π
const logs = getRecentLogs(100);

// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ brute force –ø–æ–ø—ã—Ç–∫–∏
const bruteForceLogs = getLogsByType(SecurityEventType.BRUTE_FORCE);
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

```typescript
import { getBlockInfo } from "@/lib/security/bruteForce";

const blockInfo = getBlockInfo(clientIP);
if (blockInfo.isBlocked) {
  console.log(`IP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–æ: ${new Date(blockInfo.blockedUntil)}`);
}
```

## üîê –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–∞—Ä–æ–ª—è–º

–•–æ—Ç—è —Ç–µ–∫—É—â–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

- –ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤
- –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –±—É–∫–≤, —Ü–∏—Ñ—Ä –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ –ø–∞—Ä–æ–ª–∏ (123456, password –∏ —Ç.–¥.)

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ù–µ –ª–æ–≥–∏—Ä—É–π—Ç–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**
   - –ü–∞—Ä–æ–ª–∏
   - –¢–æ–∫–µ–Ω—ã
   - –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

2. **–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏**
   - –ò—â–∏—Ç–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
   - –†–µ–∞–≥–∏—Ä—É–π—Ç–µ –Ω–∞ –∞–Ω–æ–º–∞–ª–∏–∏

3. **–û–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
   ```bash
   npm audit
   npm audit fix
   ```

4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   - –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ Git
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env.local` –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## üìù –ß–µ–∫–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- [x] Rate limiting
- [x] –ó–∞—â–∏—Ç–∞ –æ—Ç brute force
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [x] –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- [x] –ó–∞—â–∏—Ç–∞ –ø–∞—Ä–æ–ª–µ–π (bcrypt)
- [x] –ó–∞—â–∏—Ç–∞ –æ—Ç SQL injection
- [x] Middleware –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- [ ] Redis –¥–ª—è rate limiting (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- [ ] –í–Ω–µ—à–Ω–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- [ ] –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∞—É–¥–∏—Ç—ã (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

